## SQL调优

性能监控：执行耗时  show profile；

​					performance schame

**schema和数据类型优化：**

数据类型的优化：更小的通常更好，简单就好，尽量避免null，  

合理使用范式和反范式：适当的冗余可能能造成一定效率的提高，空间换时间。

主键选择： 代理主键和自然主键 推荐使用代理主键，易于维护，减少耦合 

引擎选择：Isam  innodb 

适当拆分:将经常查询的字段和不查询的字段分开存储



**执行计划**：



**通过索引进行优化**

索引的优点和用处 大大减少了服务器需要扫描的数据量，加快了查询的速度

索引的分类	主键索引 唯一索引 组合索引 全文索引 普通索引

索引采用的数据结构  innodb 采取B+树

名词：回表 索引下推 覆盖索引 最左前缀  



哈希索引：基于哈希表的实现，只能精确匹配所有列的查询  

缺点：将哈希表整个加载到内存比较耗费内存资源，对范围查询支持交叉



**优化小细节**

使用索引查询尽量不要使用表达式

尽量使用主键索引查询

使用前缀索引

强制类型转换会导致不用索引使用全表扫描

能使用limit尽量使用limit

尽量不要有null值

最好不要超过三张表join

索引并不是越多越好





查询优化 ![image-20210320221841622](C:\Users\wwwwwwl\AppData\Roaming\Typora\typora-user-images\image-20210320221841622.png)



只取自己需要的列，

避免复杂的join，禁止超过三张以上的表的join

不要使用like %abc  可以使用likeabc%

limit 

不要过多的建立索引





explain 模拟优化其是如何执行查询语句，可以从返回的数据中查看到查询语句 的瓶颈

type 访问类型 const index all

possible key  可能用在这张表中的索引， 查询字段若存在索引就会列出

keys 查询中实际使用的字段

rows 行数，估计找到所需记录读取了多少行数据

extra 扩展属性，using where    using index